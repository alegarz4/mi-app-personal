<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mi App Personal</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#6b5cff">
  <link rel="icon" href="icon.svg">

  <style>
    body{
      margin:0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(180deg,#0f1023,#1b1c3a);
      color:#fff;
      padding:20px;
    }
    h1,h2{ font-weight:600; }
    .card{
      background:rgba(255,255,255,0.08);
      border-radius:18px;
      padding:16px;
      margin-bottom:18px;
    }
    .moods button{
      margin:6px;
      padding:10px 14px;
      border-radius:20px;
      border:none;
      cursor:pointer;
      background:rgba(255,255,255,0.15);
      color:#fff;
    }
    .moods button.active{
      background:#6b5cff;
    }
    textarea,input{
      width:100%;
      border-radius:12px;
      border:none;
      padding:10px;
      margin-top:8px;
      font-size:14px;
    }
    button{
      padding:10px 14px;
      border-radius:12px;
      border:none;
      background:#6b5cff;
      color:#fff;
      cursor:pointer;
      margin-top:10px;
    }
    .secondary{
      background:rgba(255,255,255,0.15);
    }
    small{opacity:.7}
  </style>
</head>

<body>
  <h1>üåô Mi App Personal</h1>
  <small>Un espacio solo para ti</small>

  <!-- ESTADO EMOCIONAL -->
  <div class="card">
    <h2>¬øC√≥mo me siento?</h2>
    <div class="moods">
      <button onclick="setMood('Tranquila')">Tranquila</button>
      <button onclick="setMood('Ansiosa')">Ansiosa</button>
      <button onclick="setMood('Triste')">Triste</button>
      <button onclick="setMood('Indiferente')">Indiferente</button>
    </div>
    <p id="moodView">‚Äî</p>
  </div>

  <!-- PENSAMIENTO -->
  <div class="card">
    <h2>¬øQu√© pensamiento domina?</h2>
    <textarea id="thought" rows="4"></textarea>
    <button onclick="saveThought()">Guardar</button>
  </div>

  <!-- √öLTIMA LLAMADA -->
  <div class="card">
    <h2>√öltima llamada</h2>
    <input id="callWith" placeholder="Con qui√©n">
    <input id="callWhen" type="datetime-local">
    <textarea id="callNotes" rows="3" placeholder="C√≥mo te sentiste"></textarea>
    <button onclick="saveCall()">Guardar</button>
  </div>

  <!-- FRASE -->
  <div class="card">
    <h2>Frase para ti</h2>
    <textarea id="quote" rows="3"></textarea>
    <button onclick="saveQuote()">Guardar frase</button>
    <p id="quoteView">‚Äî</p>
  </div>

  <!-- RESPALDO -->
  <div class="card">
    <h2>Respaldo</h2>
    <button onclick="exportData()">Exportar</button>
    <input type="file" id="importFile" onchange="importData(event)">
    <button class="secondary" onclick="clearAll()">Borrar todo</button>
  </div>

<script>
const KEY="mi_app_personal";

let data=JSON.parse(localStorage.getItem(KEY))||{
  mood:null, thought:"",
  call:{}, quote:""
};

function save(){
  localStorage.setItem(KEY,JSON.stringify(data));
}

function setMood(m){
  data.mood=m; save();
  document.querySelectorAll('.moods button')
    .forEach(b=>b.classList.toggle('active',b.textContent===m));
  document.getElementById('moodView').textContent="Hoy: "+m;
}

function saveThought(){
  data.thought=document.getElementById('thought').value;
  save();
}

function saveCall(){
  data.call={
    with:callWith.value,
    when:callWhen.value,
    notes:callNotes.value
  };
  save();
}

function saveQuote(){
  data.quote=quote.value;
  save();
  quoteView.textContent="‚Äú"+data.quote+"‚Äù";
}

function exportData(){
  const blob=new Blob([JSON.stringify(data,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="mi_app_personal.json";
  a.click();
}

function importData(e){
  const f=e.target.files[0];
  f.text().then(t=>{
    data=JSON.parse(t);
    save(); location.reload();
  });
}

function clearAll(){
  if(confirm("¬øBorrar todo?")){
    localStorage.removeItem(KEY);
    location.reload();
  }
}

window.onload=()=>{
  if(data.mood) setMood(data.mood);
  thought.value=data.thought||"";
  quoteView.textContent=data.quote? "‚Äú"+data.quote+"‚Äù":"‚Äî";
};

if("serviceWorker" in navigator){
  navigator.serviceWorker.register("sw.js");
}
</script>
</body>
</html>
