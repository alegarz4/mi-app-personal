<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Registro discreto de regulación emocional</title>

<style>
:root{
  --bg:#0b1220; --card:#111a2e; --muted:#9fb0d0; --text:#e9efff;
  --good:#5be38f; --warn:#ffd166; --bad:#ff6b6b; --line:#1f2b48;
  --chip:#0c1428; --chipOn:#12244a;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:linear-gradient(160deg,#070b14,var(--bg));
  color:var(--text);
}
header{
  padding:14px 16px;
  background:rgba(11,18,32,.95);
  border-bottom:1px solid var(--line);
  position:sticky; top:0; z-index:10;
}
h1{margin:0;font-size:16px}
.sub{font-size:12px;color:var(--muted);margin-top:4px}
main{padding:16px;max-width:1100px;margin:auto}
.card{
  background:rgba(17,26,46,.95);
  border:1px solid var(--line);
  border-radius:14px;
  padding:14px;
  margin-bottom:14px;
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}
h2{font-size:14px;margin:0 0 10px}
label{font-size:12px;color:var(--muted);display:block;margin:10px 0 6px}
input,select,textarea{
  width:100%;padding:10px;border-radius:10px;
  border:1px solid var(--line);
  background:#0c1428;color:var(--text);
  outline:none;
}
textarea{resize:vertical;min-height:60px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.col{flex:1;min-width:220px}
.btn{
  padding:10px 14px;border-radius:10px;border:none;
  cursor:pointer;font-weight:800;
}
.btn.main{background:var(--good);color:#06210f}
.btn.sec{background:transparent;color:var(--text);border:1px solid var(--line)}
.btn.warn{background:var(--warn);color:#2b2000}
.small{font-size:11px;color:var(--muted)}
.chips{display:flex;gap:8px;flex-wrap:wrap}
.chip{
  padding:8px 10px;border-radius:999px;
  border:1px solid var(--line);
  background:var(--chip);font-size:12px;
  cursor:pointer;
}
.chip[data-on="1"]{background:var(--chipOn)}
table{width:100%;border-collapse:collapse;font-size:12px}
th,td{padding:8px 6px;border-bottom:1px solid var(--line)}
th{color:var(--muted);text-align:left}
.tag{padding:6px 10px;border-radius:999px;border:1px solid var(--line);background:#0c1428;font-size:11px}
.pill{padding:8px 10px;border-radius:999px;border:1px solid var(--line);background:#0c1428;font-size:12px}
.right{margin-left:auto}
.grid{display:grid;grid-template-columns:1.1fr .9fr;gap:12px}
@media(max-width:980px){.grid{grid-template-columns:1fr}}

.modal{
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,.55);
  align-items:center; justify-content:center;
}
.panel{
  background:#0b1220;
  border-radius:16px;
  padding:14px;
  width:min(760px,100%);
}
</style>
</head>

<body>

<header>
<div class="row">
<div>
<h1>Registro discreto de regulación emocional</h1>
<div class="sub">Uso personal · privado · guardado solo en este equipo</div>
</div>
<div class="right row">
<span class="pill" id="todayPill">Hoy: —</span>
<span class="pill" id="weekPill">Semana: —</span>
</div>
</div>
</header>

<main>
<div class="grid">

<div>
<div class="card">
<h2>Registro rápido</h2>

<label>Hora</label>
<input type="time" id="time">

<label>Nivel ansiedad</label>
<input type="number" id="anxiety" min="0" max="10" value="5">

<label>Impulso</label>
<select id="urge">
<option value="llamar">Llamar</option>
<option value="revisar">Revisar apps</option>
<option value="escribir">Escribir</option>
<option value="rumiar">Pensamientos repetitivos</option>
</select>

<label>¿Actué?</label>
<select id="acted">
<option value="resisti">Resistí</option>
<option value="actue">Actué</option>
</select>

<label>Acción de cuidado</label>
<div class="chips" id="careChips">
<div class="chip" data-key="respirar">Respiré</div>
<div class="chip" data-key="pendientes">Pendientes</div>
<div class="chip" data-key="esperar">Esperé</div>
<div class="chip" data-key="agua">Agua</div>
</div>

<label>Nota</label>
<textarea id="note"></textarea>

<div class="row">
<button class="btn main" id="save">Guardar</button>
<button class="btn warn" id="callBtn">Él me llamó</button>
</div>

<div class="small" id="saveMsg"></div>
</div>

<div class="card">
<h2>Hoy</h2>
<table>
<thead><tr><th>Hora</th><th>Ans</th><th>Evento</th></tr></thead>
<tbody id="log"></tbody>
</table>
</div>
</div>

<div>
<div class="card">
<h2>Frase</h2>
<div id="quote"></div>
<button class="btn sec" id="newQuote">Otra frase</button>
</div>

<div class="card">
<h2>Resumen semanal</h2>
<div id="weekTable"></div>
</div>
</div>

</div>
</main>

<div class="modal" id="callModal">
<div class="panel">
<h3>Él me llamó</h3>
<input type="time" id="callTime">
<input type="number" id="callAfterAnx" min="0" max="10">
<button class="btn main" id="saveCall">Guardar llamada</button>
<button class="btn sec" id="closeCall">Cerrar</button>
</div>
</div>

<script>
const KEY="registro_base_v1";

function load(){return JSON.parse(localStorage.getItem(KEY)||"[]")}
function saveAll(d){localStorage.setItem(KEY,JSON.stringify(d))}

const quotes=["Respira.","No llamar es cuidarte.","Esto también pasa.","Eres fuerte."];

document.getElementById("quote").textContent=quotes[Math.floor(Math.random()*quotes.length)];

document.getElementById("newQuote").onclick=()=>{
document.getElementById("quote").textContent=quotes[Math.floor(Math.random()*quotes.length)];
};

document.getElementById("save").onclick=()=>{
const d=load();
d.push({date:new Date().toLocaleDateString(),time:time.value,anx:anxiety.value});
saveAll(d);
alert("Guardado");
};

document.getElementById("callBtn").onclick=()=>callModal.style.display="flex";
document.getElementById("closeCall").onclick=()=>callModal.style.display="none";
document.getElementById("saveCall").onclick=()=>{
const d=load();
d.push({call:true,time:callTime.value,anx:callAfterAnx.value});
saveAll(d);
callModal.style.display="none";
alert("Llamada guardada");
};
</script>

<!-- SERVICE WORKER -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("./sw.js?v=2");
}
</script>

</body>
</html>
